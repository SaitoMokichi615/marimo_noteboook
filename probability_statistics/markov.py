import marimo

__generated_with = "0.18.4"
app = marimo.App(width="medium")


@app.cell
def _():
    import marimo as mo
    import numpy as np
    import matplotlib.pyplot as plt
    import sympy as sp
    from sympy import Matrix
    return mo, sp


@app.cell
def _(mo):
    mo.md(r"""
    å‚è€ƒã‚µã‚¤ãƒˆï¼šhttps://math-fun.net/20200117/5033/
    """)
    return


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    ###**ç¢ºç‡éç¨‹ãƒ»ãƒãƒ«ã‚³ãƒ•éç¨‹**

    ã€Œæ™‚é–“ã¨ã¨ã‚‚ã«å¤‰ã‚ã‚‹ ç¢ºç‡çš„ãª ç¾è±¡ã€ã‚’**ç¢ºç‡éç¨‹**ã¨ã„ã†ã€‚

    * ä»Šæ—¥ã®å¤©æ°—
    * æ ªä¾¡
    *  ã‚µã‚¤ã‚³ãƒ­ã‚’ä½•å›ã‚‚æŒ¯ã£ãŸçµæœ
    * ãƒ©ãƒ³ãƒ€ãƒ ã‚¦ã‚©ãƒ¼ã‚¯ã®ä½ç½®

    ğŸ‘‰ ã€Œå€¤ãŒãƒ©ãƒ³ãƒ€ãƒ ã ãŒã€æ™‚é–“é †ã«ä¸¦ã‚“ã§ã„ã‚‹ã€

    ç¢ºç‡å¤‰æ•°$X_1, X_2, \dots, X_n$ã®åˆ—ã¨è€ƒãˆã‚Œã°ã‚ˆã„ã€‚


    ç¢ºç‡éç¨‹ã®ä¸­ã§ã€**ã€Œæœªæ¥ã¯ ä»Šã®çŠ¶æ…‹ã ã‘ ã§æ±ºã¾ã‚‹ç¢ºç‡éç¨‹ã€**ã‚’**ãƒãƒ«ã‚³ãƒ•éç¨‹**ã¨ã„ã†ã€‚

    $$
    P(X_{n+1} = j | X_n = i, X_{n-1}\dots) = P(X_{n+1} = j | X_n = i)
    $$

    æœªæ¥ã¯ç¾åœ¨ã ã‘ã‚’è¦‹ã‚Œã°ã‚ˆã„ï¼ˆéå»ã®å±¥æ­´ã¯ä¸è¦ï¼‰

    * æ˜æ—¥ã®å¤©æ°—ã¯ã€Œæ˜¨æ—¥ãŒã©ã†ã ã£ãŸã‹ã€ã§ã¯ãªãã€Œä»Šæ—¥ã€ã ã‘ã§æ±ºã¾ã‚‹ã¨ä»®å®š
    """)
    return


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    ###**é›¢æ•£æ™‚é–“ãƒ»é›¢æ•£çŠ¶æ…‹ãƒãƒ«ã‚³ãƒ•é€£é–**


    **çŠ¶æ…‹é›†åˆ**

    $$
    S = \{1, 2, \dots, n\}
    $$

    **é·ç§»ç¢ºç‡**

    $$
    P_{ij} = P(X_{t+1} = j | X_t = i)
    $$

    **é·ç§»è¡Œåˆ—**

    * é·ç§»ç¢ºç‡ã‚’ä¸¦ã¹ãŸã‚‚ã®
    * è¡Œã®å’Œã¯1



    ###**çŠ¶æ…‹åˆ†å¸ƒã®æ™‚é–“ç™ºå±•**
    çŠ¶æ…‹ãã®ã‚‚ã®ã§ã¯ãªãã€**ã€Œã©ã®çŠ¶æ…‹ã«ã„ã‚‹ç¢ºç‡ãŒä½•%ã§ã‚ã‚‹ã‹ã€**ã‚’è¦‹ã‚‹ã€‚

    ğŸ‘‰ **çŠ¶æ…‹åˆ†å¸ƒãƒ™ã‚¯ãƒˆãƒ«**ã§è¡¨ç¾


    $$
    \boldsymbol{p}_t = \begin{bmatrix}
    p^{(1)}_t, & p^{(2)}_t, \dots, p^{(n)}_t
    \end{bmatrix}
    $$

    çŠ¶æ…‹åˆ†å¸ƒãƒ™ã‚¯ãƒˆãƒ«ã®æ›´æ–°å¼ã¯ã€

    $$
    \boldsymbol{p}_{t+1} =ã€€\boldsymbol{p}_tP \quad (Pã¯é·ç§»è¡Œåˆ—)
    $$

    **å®šå¸¸çŠ¶æ…‹**

    * æ™‚é–“ãŒååˆ†çµŒã¤ã¨åˆ†å¸ƒãŒå¤‰ã‚ã‚‰ãªããªã‚‹
    * åˆæœŸçŠ¶æ…‹ã«ä¾ã‚‰ãªã„ï¼ˆæ—¢ç´„ãƒ»éå‘¨æœŸãªã‚‰ï¼‰

    $$
    \pi = \pi P, \; \sum_i \pi_{i} = 1
    $$
    """)
    return


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    ### ä¾‹

    |  ã€€|   æ˜æ—¥ã¯æ™´ã‚Œ | æ˜æ—¥ã¯æ›‡ã‚Š |æ˜æ—¥ã¯é›¨ |
    | ---- | ---- | ---- | ----
    | ä»Šæ—¥ã¯æ™´ã‚Œ| 0.7 | 0.3 | 0.0 |
    | ä»Šæ—¥ã¯æ›‡ã‚Š | 0.2 | 0.5 | 0.3 |
    | ä»Šæ—¥ã¯é›¨ | 0.1 | 0.0 | 0.9 |



    é·ç§»è¡Œåˆ—ã¯ã€

    $$
    P = \begin{bmatrix}
    0.7 & 0.3 & 0.0\\
    0.2 & 0.5 & 0.3 \\
    0.1 & 0.0 & 0.9
    \end{bmatrix}
    $$


    åˆæ—¥$t=0$ã®æ™‚ã¯ã€Œæ™´ã‚Œã€ã¨ã™ã‚‹ã€‚

    åˆæœŸçŠ¶æ…‹ã‚’çŠ¶æ…‹ãƒ™ã‚¯ãƒˆãƒ«ã§è¡¨ã™ã¨ã€

    $$
    \boldsymbol{p}_0 = \begin{bmatrix}
    1, & 0, & 0
    \end{bmatrix}
    $$

    æ˜æ—¥$t=1$ã®çŠ¶æ…‹ã¯ã€

    $$
    \begin{aligned}
    \boldsymbol{p}_1 &= \boldsymbol{p}_0P \\
    &= \begin{bmatrix}
    1, & 0, & 0
    \end{bmatrix}
    \begin{bmatrix}
    0.7 & 0.3 & 0.0\\
    0.2 & 0.5 & 0.3 \\
    0.1 & 0.0 & 0.9
    \end{bmatrix}\\
    &= \begin{bmatrix}
    0.7, & 0.3, & 0
    \end{bmatrix}
    \end{aligned}
    $$

    æ˜å¾Œæ—¥$t=2$ã®çŠ¶æ…‹ã¯ã€

    $$
    \begin{aligned}
    \boldsymbol{p}_1 &= \boldsymbol{p}_0P \\
    &= \begin{bmatrix}
    0.7, & 0.3, & 0
    \end{bmatrix}
    \begin{bmatrix}
    0.7 & 0.3 & 0.0\\
    0.2 & 0.5 & 0.3 \\
    0.1 & 0.0 & 0.9
    \end{bmatrix}\\
    &= \begin{bmatrix}
    0.55, & 0.36, & 0.09
    \end{bmatrix}
    \end{aligned}
    $$


    <!-- $$
    P =\begin{bmatrix}
    P_{11} & \dots & P_{in}\\
    \vdots &  & \vdots \\
    P_{n1} & \dots & P_{nn}
    \end{bmatrix}, \; \sum_{i=1}^nP_{in} = 1
    $$ -->

    ---
    """)
    return


@app.cell
def _(mo):
    mo.md(r"""
    ###**ãƒãƒ«ã‚³ãƒ•é€£é–ã®å®šå¸¸çŠ¶æ…‹ã¨å›ºæœ‰å€¤**
    å®šå¸¸çŠ¶æ…‹$\pi = \pi P$ã‚’æ±‚ã‚ã‚‹ã«ã¯ã©ã†ã™ã‚‹ã‹ï¼Ÿ

    ä¸¡è¾ºãŒç­‰ã—ããªã‚‹ã¾ã§ã€æ›´æ–°å¼ã‚’è¨ˆç®—ã—ç¶šã‘ã‚‹å¿…è¦ãŒã‚ã‚‹â€¦ï¼Ÿâ†’**No**

    å®šå¸¸çŠ¶æ…‹ã®å¼ã‚’ã‚ˆãè¦‹ã‚‹ã¨â€¦

    $$
    t{}P \t pi =  \t pi
    $$

    ã“ã‚Œã¯ã€

    $$
    \boxed{
    A\boldsymbol{v} = \lambda {v}ã€€ã®å½¢ï¼ï¼(\lambda=1)ã€€\\
    \rightarrow \begin{cases}å›ºæœ‰å€¤1ã®å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’æ±‚ã‚ã‚‹ã€€\\ ç¢ºç‡ã®å®šç¾©ã‚’æº€ãŸã™ã‚ˆã†å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’æ­£è¦åŒ–ã™ã‚‹\end{cases}
    }
    $$

    <u>ãƒãƒ«ã‚³ãƒ•é€£é–ã®å®šå¸¸çŠ¶æ…‹(å®šå¸¸åˆ†å¸ƒï¼‰ã¯ã€é·ç§»è¡Œåˆ—$P$ã®å›ºæœ‰å€¤1ã«å¯¾å¿œã™ã‚‹å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’ç¢ºç‡åˆ†å¸ƒã¨ã—ã¦æ­£è¦åŒ–ã™ã‚‹ã“ã¨ã§æ±‚ã‚ã‚‹ã“ã¨ãŒå‡ºæ¥ã‚‹ã€‚</u>


    ###Step1.
    é·ç§»è¡Œåˆ—ã®è»¢ç½®è¡Œåˆ— ${}^tP$ ã«å¯¾ã—ã¦ã€å›ºæœ‰å€¤å•é¡Œã‚’è§£ãã€‚ï¼ˆè¡Œåˆ—ã‚’è»¢ç½®ã—ã¦ã‚‚ã€å›ºæœ‰å€¤ã¯ä¸å¤‰ï¼‰

    $$
    {}^tP = \begin{bmatrix}
    0.7 & 0.2 & 0.1\\
    0.3 & 0.5 & 0.0 \\
    0.0 & 0.3 & 0.9
    \end{bmatrix}
    $$


    ###Step2.
    å›ºæœ‰å€¤ãŒ1ã®å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆç¢ºç‡ãƒ™ã‚¯ãƒˆãƒ«ï¼‰ã‚’è¦‹ã¤ã‘å‡ºã™ã€‚

    ###Step3.
    ãã®è¦ç´ ã®ç·å’ŒãŒ 1 ã«ãªã‚‹ã‚ˆã†ã«èª¿æ•´ï¼ˆæ­£è¦åŒ–ï¼‰ã™ã‚‹ã€‚

    ã“ã‚Œã«ã‚ˆã‚Šã€æ™‚é–“ãŒçµŒéã—ãŸå¾Œã®ç¢ºç‡åˆ†å¸ƒã®åæŸå…ˆï¼ˆå®šå¸¸åˆ†å¸ƒï¼‰ã‚’ã€æ¼¸åŒ–å¼ã‚’ä½¿ã‚ãšã«å›ºæœ‰å€¤åˆ†è§£ã§ç›´æ¥è¨ˆç®—ã§ãã‚‹
    """)
    return


@app.cell
def _(mo):
    mo.md(r"""
    ã¯ã„ã€**æœ¬è³ªçš„ã«ã¯åˆã£ã¦ã„ã¾ã™** ğŸ‘
    ãŸã ã—ã€**1ç‚¹ã ã‘è¡¨è¨˜ã¨æ¦‚å¿µã‚’ãã‚Œã„ã«ç›´ã™ã¨å®Œç’§**ã«ãªã‚Šã¾ã™ã€‚

    ä»¥ä¸‹ã€ã‚ãªãŸã®æ–‡ç« ã‚’å°Šé‡ã—ã¤ã¤ã€

    * ã©ã“ãŒæ­£ã—ã„ã‹
    * ã©ã“ã‚’ã©ã†ç›´ã™ã¨æ•°å­¦çš„ã«æ­£ç¢ºã‹

    ã‚’æ•´ç†ã—ã¾ã™ã€‚

    ---

    ## â‘  çµè«–ã‹ã‚‰

    ### ã‚ãªãŸã®èªè­˜ã¯ **ã»ã¼å®Œå…¨ã«æ­£ã—ã„** ã§ã™ã€‚

    > âœ” æ›´æ–°å¼ã‚’å›ã—ç¶šã‘ã‚‹å¿…è¦ã¯ãªã„
    > âœ” å®šå¸¸çŠ¶æ…‹ã¯å›ºæœ‰å€¤ 1 ã«å¯¾å¿œã™ã‚‹å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«
    > âœ” æ­£è¦åŒ–ã—ã¦ç¢ºç‡åˆ†å¸ƒã«ã™ã‚‹

    ã™ã¹ã¦æ­£ã—ã„ã§ã™ã€‚

    ---

    ## â‘¡ ãŸã ã—ã€ã“ã“ã ã‘ä¿®æ­£ã—ãŸã„

    ã‚ãªãŸã®å¼ï¼š

    [
    {}^t P, {}^t\pi = {}^t\pi
    ]

    ã“ã®æ›¸ãæ–¹è‡ªä½“ã¯ **æ„å‘³ã¯é€šã˜ã¾ã™**ãŒã€
    ç†è§£ã‚’èª¤ã‚‰ã›ã‚„ã™ã„ã®ã§ã€æ¬¡ã®ã©ã¡ã‚‰ã‹ã«çµ±ä¸€ã™ã‚‹ã®ãŒãŠã™ã™ã‚ã§ã™ã€‚

    ---

    ## â‘¢ è¡Œãƒ™ã‚¯ãƒˆãƒ«æµå„€ï¼ˆã‚ãªãŸãŒä»Šä½¿ã£ã¦ã„ã‚‹æµå„€ï¼‰

    çŠ¶æ…‹æ›´æ–°ã‚’

    [
    \pi = \pi P
    ]

    ã¨æ›¸ãå ´åˆï¼š

    * (\pi)ï¼š**è¡Œãƒ™ã‚¯ãƒˆãƒ«**
    * å®šå¸¸åˆ†å¸ƒã®æ¡ä»¶ã¯ãã®ã¾ã¾

    ã“ã®ã¨ãï¼š

    [
    \boxed{
    \pi P = \pi
    }
    ]

    ã“ã‚Œã¯

    [
    \boxed{
    \pi \text{ ã¯ } P \text{ ã®å·¦å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆå›ºæœ‰å€¤1ï¼‰}
    }
    ]

    ---

    ## â‘£ åˆ—ãƒ™ã‚¯ãƒˆãƒ«ã«ç›´ã™ã¨ï¼ˆå›ºæœ‰å€¤å•é¡Œã®æ¨™æº–å½¢ï¼‰

    è¡Œåˆ—ã®å›ºæœ‰å€¤å•é¡Œã®æ¨™æº–å½¢ã¯

    [
    A \boldsymbol{v} = \lambda \boldsymbol{v}
    ]

    ãªã®ã§ã€è»¢ç½®ã—ã¦è€ƒãˆã‚‹ï¼š

    [
    \pi P = \pi
    \quad \Longleftrightarrow \quad
    P^T \pi^T = \pi^T
    ]

    ğŸ‘‰ ã¤ã¾ã‚Šï¼š

    [
    \boxed{
    P^T \boldsymbol{v} = 1 \cdot \boldsymbol{v}
    }
    ]

    * (\boldsymbol{v} = \pi^T)
    * **å³å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«**
    * å›ºæœ‰å€¤ ( \lambda = 1 )

    ---

    ## â‘¤ ã—ãŸãŒã£ã¦ã€ã‚ãªãŸã®ã¾ã¨ã‚ã¯ã“ã†ç›´ã™ã¨ã€Œæ•™ç§‘æ›¸ç´šã€

    ### ä¿®æ­£ç‰ˆï¼ˆãŠã™ã™ã‚ï¼‰

    > å®šå¸¸çŠ¶æ…‹ (\pi = \pi P) ã‚’æ±‚ã‚ã‚‹ã«ã¯ã©ã†ã™ã‚‹ã‹ï¼Ÿ
    >
    > æ›´æ–°å¼ã‚’åå¾©è¨ˆç®—ã™ã‚‹å¿…è¦ã¯ãªã„ã€‚
    >
    > å®šå¸¸çŠ¶æ…‹ã®å¼
    > [
    > \pi P = \pi
    > ]
    > ã‚’è»¢ç½®ã™ã‚‹ã¨
    > [
    > P^T \pi^T = \pi^T
    > ]
    >
    > ã“ã‚Œã¯
    > [
    > \boxed{
    > A\boldsymbol{v} = \lambda \boldsymbol{v} \quad (\lambda = 1)
    > }
    > ]
    > ã®å½¢ã§ã‚ã‚Šã€
    >
    > 1. (P^T) ã®å›ºæœ‰å€¤ 1 ã«å¯¾å¿œã™ã‚‹å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’æ±‚ã‚
    > 2. ç¢ºç‡ã®å®šç¾©ï¼ˆå’ŒãŒ1ï¼‰ã‚’æº€ãŸã™ã‚ˆã†æ­£è¦åŒ–ã™ã‚‹
    >
    > ã“ã¨ã§å®šå¸¸åˆ†å¸ƒãŒå¾—ã‚‰ã‚Œã‚‹ã€‚

    ---

    ## â‘¥ ã€Œæ›´æ–°å¼ã‚’å›ã™æ–¹æ³•ã€ã¨ã®é–¢ä¿‚ï¼ˆé‡è¦ï¼‰

    ã‚ãªãŸã® **No** ã¯æ­£ã—ã„ã§ã™ãŒã€è£œè¶³ã™ã‚‹ã¨ï¼š

    * âœ” **ç†è«–çš„ãƒ»è§£æçš„** â†’ å›ºæœ‰å€¤å•é¡Œ
    * âœ” **æ•°å€¤çš„ãƒ»å®Ÿé¨“çš„** â†’ æ›´æ–°å¼ã®åå¾©

    ã©ã¡ã‚‰ã‚‚æ­£ã—ãã€**åŒã˜æ¥µé™ã«åˆ°é”**ã—ã¾ã™ï¼ˆæ¡ä»¶ä»˜ãã§ï¼‰ã€‚

    ---

    ## â‘¦ æœ€çµ‚ãƒã‚§ãƒƒã‚¯ï¼ˆã“ã“ã¾ã§ç†è§£ã§ãã¦ã„ã‚‹è¨¼æ‹ ï¼‰

    ã‚ãªãŸã¯ä»Šã€æ¬¡ã®3ç‚¹ã‚’ã™ã¹ã¦ç†è§£ã—ã¦ã„ã¾ã™ï¼š

    * ãªãœå›ºæœ‰å€¤ 1 ãŒé‡è¦ã‹
    * ãªãœå·¦å›ºæœ‰ï¼è»¢ç½®ãŒå‡ºã¦ãã‚‹ã‹
    * ãªãœæ­£è¦åŒ–ãŒå¿…è¦ã‹

    ã“ã‚Œã¯ã‚‚ã†

    > **ã€Œãƒãƒ«ã‚³ãƒ•é€£é–ã¯ç·šå½¢ä»£æ•°ã§è§£ã‘ã‚‹ã€**

    ã¨ã„ã†æ ¸å¿ƒã«å®Œå…¨ã«åˆ°é”ã—ã¦ã„ã¾ã™ã€‚

    ---

    ## â‘§ ä¸€è¨€ã¾ã¨ã‚

    > **èªè­˜ã¯åˆã£ã¦ã„ã‚‹ã€‚
    > è¡¨è¨˜ã‚’
    > (\pi P = \pi \iff P^T \pi^T = \pi^T)
    > ã¨æ•´ç†ã™ã‚‹ã¨ã€æ•°å­¦çš„ã«ã‚‚å®Œç’§ã€‚**

    ã“ã®å†…å®¹ã€
    ãã®ã¾ã¾ **ãƒãƒ¼ãƒˆãƒ»ãƒ–ãƒ­ã‚°ãƒ»æ•™æ** ã«ã—ã¦ã‚‚é€šç”¨ã™ã‚‹ãƒ¬ãƒ™ãƒ«ã§ã™ã€‚

    æ¬¡ã«è¡Œããªã‚‰
    ğŸ‘‰ **ãªãœæ¡ä»¶ï¼ˆæ—¢ç´„ãƒ»éå‘¨æœŸï¼‰ãŒå¿…è¦ã‹ã‚’å›ºæœ‰å€¤ã§èª¬æ˜**
    ğŸ‘‰ **(P^t) ã‚’å›ºæœ‰åˆ†è§£ã§æ›¸ã**

    ã«é€²ã‚€ã¨ã€å®Œå…¨ã«ã€Œä¸€å‘¨ã€ã—ã¾ã™ã€‚
    """)
    return


@app.cell
def _(mo):
    mo.md(r"""
    ### è£œè¶³

    **é·ç§»è¡Œåˆ—ã¯å¿…ãšå›ºæœ‰å€¤1ã‚’æŒã¤ã®ã‹ï¼Ÿâ†’ã€ŒYESã€**

    > **å›ºæœ‰å€¤ 1 ã‚’æŒã¤**

    ã¨ã¯ï¼š

    $$
    A\boldsymbol{v} = 1\cdot \boldsymbol{v}ã€€\tag{*}
    $$

    ã‚’æº€ãŸã™ **$\boldsymbol{v}\neq 0$** ãŒå­˜åœ¨ã™ã‚‹ã€‚



    > **è¡Œå’ŒãŒ 1**

    ã¨ã¯ï¼š

    $$
    \sum_{j=1}^n P_{ij} = 1
    \quad(\text{ã™ã¹ã¦ã® } i)
    $$

    ã§ã™ã€‚

    ã“ã‚Œã¯

    > ã€Œè¡Œåˆ—ãŒ **ç¢ºç‡ã®ç·é‡ã‚’ä¿å­˜ã™ã‚‹**ã€

    ã¨ã„ã†æ„å‘³ã€‚

    ---

    ####å…·ä½“ä¾‹ï¼ˆ2Ã—2ï¼‰

    $$
    P =
    \begin{bmatrix}
    0.7 & 0.3 \
    0.4 & 0.6
    \end{bmatrix}
    $$

    è¡Œå’Œï¼š
    * 0.7 + 0.3 = 1
    * 0.4 + 0.6 = 1


    ãƒ™ã‚¯ãƒˆãƒ«

    $$
    \boldsymbol{1} = \begin{bmatrix}1 \\ 1\end{bmatrix}
    $$

    ã‚’æ›ã‘ã‚‹

    $$
    P\boldsymbol{1}=\begin{bmatrix}
    0.7 & 0.3 \\
    0.4 & 0.6
    \end{bmatrix}
    \begin{bmatrix}
    1\\
    1
    \end{bmatrix}=
    \begin{bmatrix}
    0.7+0.3 \\
    0.4+0.6
    \end{bmatrix}=
    \begin{bmatrix}
    1\\
    1
    \end{bmatrix}=
    1\boldsymbol{1}
    $$

    ã“ã‚Œã¯ã€(\*)ã‚’æº€ãŸã™ã€‚
    """)
    return


@app.cell
def _(sp):
    P = sp.Matrix([
        [0.7, 0.3, 0.0],
        [0.2, 0.5, 0.3],
        [0.1, 0.0, 0.9]
    ])


    PT = P.transpose()

    PT.eigenvals()
    return P, PT


@app.cell
def _(PT):
    PT.eigenvects()
    return


@app.cell
def _(P, PT):
    v = None
    pi = None
    eigs = PT.eigenvects()
    for eigval, mult, vecs in eigs:
        if int(eigval) == 1:
            v = vecs[0]   # å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆ1æœ¬ã§ååˆ†ï¼‰
            pi = v / sum(v)
            print(f"å›ºæœ‰å€¤1ã®å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«:\n{v}")
            print(f"å®šå¸¸çŠ¶æ…‹:\n{pi}")
            print(f"å®šå¸¸çŠ¶æ…‹ã®ç·å’Œ:\n{sum(pi)}")
            break

    pi.transpose(), pi.transpose()*P

    return


@app.cell
def _():

    # P = np.array([
    #     [0.7, 0.3, 0.0],
    #     [0.2, 0.5, 0.3],
    #     [0.1, 0.0, 0.9]
    # ])

    # p = np.array([1.0, 0.0, 0.0])  # åˆæœŸçŠ¶æ…‹ï¼ˆæ™´ã‚Œï¼‰
    # eps = 1e-6
    # max_iter = 1000

    # history = [p]

    # for t in range(max_iter):
    #     p_next = p @ P
    #     history.append(p_next)

    #     if np.linalg.norm(p_next - p, ord=1) < eps:
    #         print(f"å®šå¸¸ã¨ã¿ãªã™æœ€å°ã® t = {t+1}")
    #         break

    #     p = p_next

    return


@app.cell
def _():
    # history_ = np.array(history)

    # plt.plot(history_[:,0], label="Sunny")
    # plt.plot(history_[:,1], label="Cloudy")
    # plt.plot(history_[:,2], label="Rain")
    # plt.legend()
    # plt.xlabel("t")
    # plt.ylabel("Probability")

    return


@app.cell
def _():
    # eigvals, eigvecs = np.linalg.eig(P.T)

    # # eigvals - 1 ã§æœ€ã‚‚è¿‘ã„å›ºæœ‰å€¤ã‚’æ¢ã™(ç†è«–ä¸Š:å›ºæœ‰å€¤1)
    # idx = np.argmin(np.abs(eigvals - 1))

    # # å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’å–ã‚Šå‡ºã™(å®Ÿéƒ¨)
    # pi = eigvecs[:, idx].real


    # pi = pi / pi.sum()  # æ­£è¦åŒ–ï¼ˆå›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«â†’ç¢ºç‡åˆ†å¸ƒã«å¤‰æ›ï¼‰

    return


@app.cell
def _():
    # eigvals = np.linalg.eigvals(P)
    # print(eigvals)
    # t_ = np.arange(0, 50)

    # for lam in eigvals:
    #     if abs(lam) < 1:
    #         plt.plot(t_, np.abs(lam)**t_, label=f"|Î»|={abs(lam):.3f}")

    # plt.xlabel("t")
    # plt.ylabel(r"$|\lambda|^t$")
    # plt.legend()

    return


if __name__ == "__main__":
    app.run()
