import marimo

__generated_with = "0.18.4"
app = marimo.App(width="medium")


@app.cell
def _():
    import marimo as mo
    import sympy as sp
    import numpy as np
    import matplotlib.pyplot as plt
    return mo, np, plt, sp


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    ###**ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ã®å†·å´æ³•å‰‡**

    ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ã®å†·å´æ³•å‰‡ã¨ã¯ã€

    ã€Œå¤§æ°—ä¸­ã«ç½®ã‹ã‚ŒãŸç‰©ä½“ãŒå†·å´ã™ã‚‹é€Ÿåº¦ã¯ã€ãã®ç‰©ä½“ã®æ¸©åº¦ã¨å¤–æ°—æ¸©ã¨ã®å·®ã«æ¯”ä¾‹ã™ã‚‹ã€

    ã¨ã„ã†ã‚‚ã®ã§ã‚ã‚‹ã€‚

    ---
    æ®ºäººäº‹ä»¶ã®è¢«å®³è€…ã®æ­»ä½“ãŒã€ã‚ã‚‹å¤œ10æ™‚ã«ç™ºè¦‹ã•ã‚ŒãŸã€‚

    ç›´ã¡ã«ä½“æ¸©ã‚’è¨ˆã£ãŸã¨ã“ã‚ã€32.4â„ƒã§ã‚ã£ãŸã€‚

    1æ™‚é–“å¾Œã«ã‚‚ã†ä¸€åº¦è¨ˆã£ã¦ã¿ã‚‹ã¨ã€31.7â„ƒã§ã‚ã£ãŸã€‚

    å¤–æ°—ã®æ¸©åº¦ã¯20.0â„ƒã§ä¸€å®šã¨ã—ã€è¢«å®³è€…ã®æ™®æ®µã®ä½“æ¸©ã‚’36.5â„ƒã¨ã™ã‚‹ã¨ãã€ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ã®å†·å´æ³•å‰‡ã«åŸºã¥ãã€æ­»äº¡æ™‚åˆ»ã‚’æ¨å®šã›ã‚ˆã€‚
    """)
    return


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    ---

    ####**(A) å¤§æ°—ä¸­ã«ç½®ã‹ã‚ŒãŸç‰©ä½“ã¯å†·å´ã™ã‚‹**

    * æ™‚åˆ»$t$ã«ãŠã‘ã‚‹å¤–æ°—æ¸©ã¨ä½“æ¸©ã®å·®ã‚’$T(t)$ã¨ã™ã‚‹
    * æ¸©åº¦å·®ã®æ™‚é–“å¤‰åŒ–ã¯ è² 
    * æ¸©åº¦å·®ã®æ™‚é–“å¤‰åŒ–ã¯ã€å¾®åˆ†ã§ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã‘ã‚‹

    $$
    \frac{dT}{dt}
    $$

    ####**(B) æ¸©åº¦å·®ã®æ™‚é–“å¤‰åŒ–ã¯ã€Œæ¸©åº¦å·®ã€ã«æ¯”ä¾‹**

    * ã€Œæ¸©åº¦å·®ãŒå¤§ãã„ã»ã©ã€æ¸©åº¦å¤‰åŒ–ã¯å¤§ãã„ã€ã¨ã„ã†ä»®å®šã€‚

    $$
    \frac{dT}{dt} \propto T
    $$
    """)
    return


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    ---

    ###**æ–‡ç«  â†’ æ•°å¼ã¸ã®ç¿»è¨³**

    (A)(B) ã‚’ã™ã¹ã¦æ›ã‘åˆã‚ã›ã‚‹ã¨ï¼š

    $$
    \boxed{
    \frac{dT}{dt}  = -kT
    } \tag{1.}
    $$

    * $k > 0$:æ¯”ä¾‹å®šæ•°(æ¸©åº¦ä½ä¸‹ã®é€Ÿã•)
    """)
    return


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    ---

    (1.)ã‚’å¤‰å½¢ã™ã‚‹ã¨ã€

    $$
    \frac{ï¼‘}{T}\frac{dT}{dt}  = -k
    $$

    ä¸¡è¾ºã‚’$t$ã§ç©åˆ†ã™ã‚‹ã¨ã€


    $$
    \int{\frac{1}{T}\frac{dT}{dt}dt}  = -\int{kdt}
    $$


    $$
    \int{\frac{1}{T}dT}  = -k\int{dt} \tag{2.}
    $$

    ã“ã‚Œã‚ˆã‚Šã€

    $$
    \log{\left|T\right|} = -kt + c \quad (cã¯ä»»æ„å®šæ•°)
    $$

    $$
    T = e^{-kt + c} = e^{c}e^{-kt} \tag{3.}
    $$


    (3.)ã«ã¤ã„ã¦ã€$t=0$ã¨ã—ã€$T(t=0) = T_0$ã¨ã™ã‚‹ã¨ã€


    $$
    e^c = T_0
    $$


    ã—ãŸãŒã£ã¦ã€

    $$
    \boxed{
    T = T_0e^{-kt}
    } \tag{4.}
    $$

    <!-- $$
    \int{\left(\frac{1}{N} + \frac{1}{N_{\infty}-N}\right)dN}  = \int{kdt}  \tag{2.}
    $$ -->
    <!--
    (2.) ã«ã¤ã„ã¦ã€

    $$
    \begin{aligned}
    (å·¦è¾º)  &=\log{|N|} - \log{|N_{\infty} - N|} + c_1 \\
    &= \log{\left|\dfrac{N}{N_{\infty} - N}\right|} + c_1 \quad (c_1ã¯ä»»æ„å®šæ•°)
    \end{aligned}
    $$

    $$
    (å³è¾º) = kt + c_2 \quad (c_2ã¯ä»»æ„å®šæ•°)
    $$

    ã“ã‚Œã‚ˆã‚Šã€

    $$
    \log{\left|\dfrac{N}{N_{\infty} - N}\right|} = kt + c \tag{3.}
    $$

    ãŸã ã—ã€$c=c_2-c_1$ã¯ä»»æ„å®šæ•°ã€‚

    ã‚ˆã£ã¦ã€

    $$
    \frac{N}{N_{\infty} - N} = e^{kt + C} = e^{c}e^{kt} \tag{4.}
    $$


    (3.)ã«ã¤ã„ã¦ã€$t=0$ã¨ã—ã€$N(t=0) = N_0$ã¨ã™ã‚‹ã¨ã€

    $$
    e^c = \frac{N_0}{N_{\infty} - N_0}
    $$

    ã—ãŸãŒã£ã¦ã€

    $$
    \boxed{
    \frac{N}{N_{\infty} - N} = \frac{N_0}{N_{\infty} - N_0}e^{kt}
    } \tag{5.}
    $$ -->
    """)
    return


@app.cell
def _():
    return


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    ---
    æ•°å€¤ã‚’ä½¿ã£ã¦ $k$ã‚’æ±ºã‚ã‚‹ã€‚åŸºæº–æ™‚åˆ» **å¤œ10æ™‚ã‚’ $t=0$** ã¨ã™ã‚‹ã€‚


    * $T(0)=T_0 = 32.4-20.0 = 12.4$
    * $T(1)= 31.7-20.0 = 11.7$


    (4.)ã«$t=1$ã‚’ä»£å…¥

    $$
    T(1)
    = T_0e^{-k}
    $$


    $$
    e^{-k} = \frac{T(1)}{T_0}  = \frac{11.7}{12.4}\approx 0.9435
    $$

    $$
    k = -\ln(0.9435)\approx 0.058
    $$

    ---

    > **æ­»äº¡æ™‚åˆ»ã¨ã¯ã€ä½“æ¸©ãŒå¹³å¸¸å€¤ã ã£ãŸæ™‚åˆ»**


    æ­»äº¡æ™‚åˆ»ã¯22:00ã‚ˆã‚Šå‰ãªã®ã§ã€$t<0$

    æ­»äº¡æ™‚åˆ»ã«ãŠã‘ã‚‹æ¸©åº¦å·®ã¯ã€

    $$
    T_{\text{death}} = 36.5âˆ’20.0=16.5
    $$


    (4.)ã«ä»£å…¥ã™ã‚‹ã¨ã€

    $$
    16.5=12.4e^{-kt}
    $$


    $$
    e^{-kt} = \frac{12.5}{16.5} \approx 1.331
    $$

    $$
    -kt = \ln(1.331) \approx 0.286
    $$

    $$
    t = -\frac{0.286}{0.058}\approx -4.9
    $$

    ã—ãŸãŒã£ã¦ã€

    $$
    \begin{aligned}
    &\boxed{
    \text{æ­»äº¡æ¨å®šæ™‚åˆ» } \approx \text{åˆå¾Œ10æ™‚} - 4.9 \text{ æ™‚é–“}
    }\\
    \Longrightarrow
    &\boxed{\text{åˆå¾Œ5æ™‚æ™‚é ƒ}}
    \end{aligned}
    $$
    <!--
    $$
    -k = \log{|T(1)|} - \log{|T_0|} = \frac{11.7}{12.4}
    $$ -->

    <!--
    $$
    \frac{1.25}{1.30} \approx 0.9615
    \Rightarrow 1+Ae^{-5k} \approx 1.04
    $$

    $$
    Ae^{-5k} \approx 0.04
    \Rightarrow e^{-5k}\approx \frac{0.04}{0.0569}\approx 0.70
    $$

    $$
    -5k=\ln(0.70)\approx -0.35
    \Rightarrow k\approx 0.070
    $$

    ---

    2010å¹´ã®äººå£äºˆæ¸¬

    $$
    e^{-10k}=e^{-0.70}\approx 0.49
    $$


    $$
    N(10)=\frac{1.3\times10^8}{1+0.0569\times0.49}
    \approx \frac{1.3\times10^8}{1.028}
    \approx 1.26\times10^8
    $$

    $$
    \boxed{
    \text{2010å¹´ã®äººå£ } \approx 1.26\times10^8 \text{ äºº}
    }
    $$ -->
    """)
    return


@app.cell
def _(sp):
    # è¨˜å·
    k = sp.symbols('k', real=True)
    t = sp.symbols('t', real=True)

    # å®šæ•°
    T0 = 12.4
    T1 = 11.7

    # åˆå¾Œ10æ™‚ï¼ˆt=0ï¼‰ã§æ–¹ç¨‹å¼ã‚’ç«‹ã¦ã‚‹
    eq = sp.Eq(
        T1,
        T0 * sp.exp(-k)
    )

    # k ã‚’è§£ã
    k_val = sp.solve(eq, k)[0]
    # k_val.evalf(3)
    return T0, k_val


@app.cell
def _(T0, k_val, sp):
    # å®šæ•°
    T_death = 16.5


    # æ­»äº¡æ¨å®šæ™‚åˆ»ã§æ–¹ç¨‹å¼ã‚’ç«‹ã¦ã‚‹
    # XXX: ä¸‹è¨˜ã ã¨ç„¡é™ãƒ«ãƒ¼ãƒ—
    # eq_ = sp.Eq(
    #     T_death,
    #     T0 * sp.exp(-k_val*t)
    # )

    # å¯¾æ•°ã«ç›´ã™
    t_val = - (1 / k_val) * sp.log(T_death / T0)

    # t ã‚’è§£ã
    t_val.evalf(3)
    return


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    ### æ³¨æ„

    <!-- **SymPy ãŒã€Œä¸€èˆ¬è§£ã‚’å³å¯†ã«æ±‚ã‚ã‚ˆã†ã¨ã—ã¦è¿·å­ã«ãªã£ãŸã€**ã®ãŒç†ç”±ã§ã™ã€‚ -->


    `k_val` ãŒã€Œæ•°å€¤ï¼ˆevalf æ¸ˆã¿ï¼‰ã€ãªã®ã«ã€

    `solve` ãŒã€Œè¨˜å·æ–¹ç¨‹å¼ã¨ã—ã¦å³å¯†è§£ã€ã‚’æ¢ãã†ã¨ã™ã‚‹ã¨ã€

    è¨ˆç®—ãŒçµ‚ã‚ã‚‰ãªã„ï¼

    ---

    #### ä½•ãŒèµ·ãã¦ã„ãŸã‹ï¼ˆä¸­èº«ï¼‰

    ã‚ãªãŸã®å¼ã¯

    ```python
    T_death = T0 * exp(-k_val * t)
    ```

    ã“ã“ã§ï¼š

    * `t` â€¦â€¦ è¨˜å·
    * `k_val` â€¦â€¦ **æ•°å€¤ï¼ˆæµ®å‹•å°æ•°ï¼‰**
    * `exp(æ•°å€¤ * t)` â€¦â€¦ **è¶…è¶Šé–¢æ•°**

    SymPy ã¯ã“ã‚Œã‚’è¦‹ã¦ï¼š

    > ã€Œä¸€èˆ¬ã® ( a e^{bt} = c ) ã‚’ã€
    > è¨˜å·çš„ã«å®Œå…¨ãªå½¢ã§è§£ã‘ã¨è¨€ã‚ã‚Œã¦ã„ã‚‹â€¦ï¼Ÿã€

    ã¨è§£é‡ˆã—ã€
    **è§£æçš„ãªè§£ã®æ¢ç´¢ãƒ«ãƒ¼ãƒ—ã«å…¥ã£ã¦æ­¢ã¾ã‚‹**ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

    ---

    #### ãªãœ 1å€‹ç›®ï¼ˆk ã‚’è§£ãï¼‰ã¯ã™ãçµ‚ã‚ã£ãŸã®ã‹ï¼Ÿ

    ```python
    T1 = T0 * exp(-k)
    ```

    ã“ã‚Œã¯ï¼š

    * æœªçŸ¥æ•°ï¼š`k`
    * æ§‹é€ ï¼š**å˜ç´”ãªæŒ‡æ•°æ–¹ç¨‹å¼**
    * ä¿‚æ•°ï¼šå…¨éƒ¨ã‚·ãƒ³ãƒœãƒ« or æœ‰ç†æ•°

    ğŸ‘‰

    $$
    k = -\log{\left|\dfrac{T(1)}{T_0} \right|}
    $$

    ã¨ **å³æ–­**ã§ãã¾ã™ã€‚

    ---

    #### ãªãœ t ã‚’è§£ãã¨æ­¢ã¾ã‚‹ã®ã‹ï¼Ÿ

    ```python
    T_death = T0 * exp(-k_val * t)
    ```

    * ä¿‚æ•°ã« **æµ®å‹•å°æ•°ç‚¹**
    * å¯¾è±¡ã¯ **è¶…è¶Šæ–¹ç¨‹å¼**
    * `solve()` ã¯ã€Œå³å¯†è§£ã€ã‚’è¿”ãã†ã¨ã™ã‚‹

    ğŸ‘‰
    **ã€Œlog ã‚’å–ã‚Œã°çµ‚ã‚ã‚‹ã€ã“ã¨ã‚’ SymPy ãŒè‡ªå‹•ã§ä¿è¨¼ã§ããªã„**

    ---

    #### æ­£ã—ã„å¯¾å‡¦æ³•â‘ ï¼ˆã„ã¡ã°ã‚“ç°¡å˜ï¼‰

    * **è‡ªåˆ†ã§ log ã‚’å–ã‚‹**

    æ•°å­¦çš„ã«ã¯ï¼š

    $$
    t = -\frac{1}{k}\ln\frac{T_{\text{death}}}{T_0}
    $$

    ãªã®ã§ï¼š

    ```python
    t_val = - (1 / k_val) * sp.log(T_death / T0)
    t_val.evalf(3)
    ```

    âœ” ä¸€ç¬ã§çµ‚ã‚ã‚‹

    âœ” æ•°å­¦çš„ã«ã‚‚æœ€ã‚‚é€æ˜

    ---

    #### æ­£ã—ã„å¯¾å‡¦æ³•â‘¡ï¼ˆSymPyæµã«è§£ã‹ã›ãŸã„å ´åˆï¼‰

    *  `solve` ã§ã¯ãªã `logsolve`

    ```python
    t_val = sp.solve_univariate_inequality(
        T0 * sp.exp(-k_val * t) - T_death,
        t
    )
    ```

    ãŸã ã—ä»Šå›ã®ã‚ˆã†ãª **ç­‰å¼** ã§ã¯â‘ ã®æ–¹ãŒé©åˆ‡ã§ã™ã€‚

    ---

    #### æ­£ã—ã„å¯¾å‡¦æ³•â‘¢ï¼ˆæ•°å€¤è§£ã«å‰²ã‚Šåˆ‡ã‚‹ï¼‰

    *  `nsolve` ã‚’ä½¿ã†

    ```python
    t_val = sp.nsolve(
        T0 * sp.exp(-k_val * t) - T_death,
        t,
        -5   # åˆæœŸå€¤ï¼ˆåˆå¾Œ10æ™‚ã‚ˆã‚Šå‰ï¼‰
    )
    ```

    âœ” æ•°å€¤è§£å°‚ç”¨

    âœ” åˆæœŸå€¤å¿…é ˆ

    âœ” æ¨å®šå•é¡Œã§ã¯ã‚€ã—ã‚è‡ªç„¶

    ---

    #### é‡è¦ãªæ•™è¨“ï¼ˆã‹ãªã‚Šå¤§äº‹ï¼‰

    ### SymPy ã®åŸå‰‡

    | çŠ¶æ³        | ä½¿ã†ã¹ãæ‰‹æ®µ              |
    | --------- | ------------------- |
    | å³å¯†è§£ãŒæ¬²ã—ã„   | `solve`             |
    | æ•°å€¤ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å…¥ã‚Š | **è‡ªåˆ†ã§å¤‰å½¢ or nsolve** |
    | å˜èª¿ãªæŒ‡æ•°     | log ã‚’æ‰‹ã§å–ã‚‹           |
    | æ¨å®šå•é¡Œ      | nsolve              |

    ---

    #### ä»Šå›ã®ä¸€æ–‡ã¾ã¨ã‚

    > **`solve` ã¯è³¢ã™ãã¦ã€æ•°å€¤å…¥ã‚ŠæŒ‡æ•°æ–¹ç¨‹å¼ã‚’ã€Œä¸€èˆ¬è«–ã€ã§è§£ã“ã†ã¨ã—ã¦æ­¢ã¾ã£ãŸ**

    ã‚ãªãŸã®ç†è§£ãƒ»å¼ãƒ»ã‚³ãƒ¼ãƒ‰ã®æ–¹å‘æ€§ã¯ **å®Œå…¨ã«æ­£ã—ã„**ã§ã™ã€‚
    SymPy ã®ã€Œæ€§æ ¼ã€ã‚’ä¸€æ®µæ·±ãç†è§£ã—ãŸã€ã‚€ã—ã‚è‰¯ã„ãƒˆãƒ©ãƒ–ãƒ«ã§ã™ã€‚

    <!-- æ¬¡ã¯

    * ã€Œãªãœ log ã‚’å–ã‚Œã°ä¸€æ„ã«è§£ã‘ã‚‹ã®ã‹ï¼ˆå˜èª¿æ€§ï¼‰ã€
    * ã€Œæ•°å€¤æ¨å®šã§ã¯ nsolve ãŒè‡ªç„¶ãªç†ç”±ã€

    ã©ã¡ã‚‰ã«é€²ã¿ã¾ã™ï¼Ÿ -->
    """)
    return


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    (4.)ã‚’æ¨ªè»¸$t$,ç¸¦è»¸$T$ã§ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ã€‚
    """)
    return


@app.cell
def _(T0, k_val, np, plt):

    # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    k_ = float(k_val)

    # æ¸©åº¦ãƒ¢ãƒ‡ãƒ«ï¼ˆæŒ‡æ•°æ¸›è¡°ï¼‰
    def T(t):
        return T0 * np.exp(-k_ * t)

    t_ = np.linspace(-4, 48, 300)

    plt.plot(t_, T(t_), label="Temperature model")
    plt.axhline(T0, linestyle="--", alpha=0.5, label="Initial temperature $T_0$")
    plt.xlabel("t (hours from 22:00)")
    plt.ylabel("Temperature")
    plt.title("Exponential Cooling Model")
    plt.legend()
    plt.grid(alpha=0.3)
    plt.show()

    return (k_,)


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    <!-- ### ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ›²ç·š

    > èªæºï¼šlogisticã€Œç‰©æµãƒ»è£œçµ¦ã€ã€logisticsï¼ˆå…µç«™ãƒ»è£œçµ¦ï¼‰

    ã€Œã©ã‚Œã ã‘ç‰©è³‡ã‚’é‹ã¹ã‚‹ã‹ã€ã€Œã©ã“ã¾ã§ç¶­æŒã§ãã‚‹ã‹ã€

    ğŸ‘‰ ç„¡é™ã«ã¯å¢—ã‚„ã›ãªã„


    * åˆæœŸï¼šæŒ‡æ•°æˆé•·ã«è¿‘ã„
    * ä¸­æœŸï¼šæˆé•·ãŒéˆåŒ–
    * å¾ŒæœŸï¼šä¸Šé™ã§åœæ­¢

     **ã€Œäººå£ãŒå¢—ãˆã‚‹ã»ã©ã€äººå£æŠ‘åˆ¶ãŒå¼·ããªã‚‹ã€**

     <!--
    ãã®çµæœâ€¦
    äººå£ (N)
    å¢—ãˆæ–¹
    å°ã•ã„
    ã¾ã äººãŒå°‘ãªã„ â†’ ã‚†ã£ãã‚Š
    ä¸­ãã‚‰ã„
    äººã‚‚å¤šãä½™åŠ›ã‚‚ã‚ã‚‹ â†’ æœ€ã‚‚é€Ÿã„
    å¤§ãã„
    ä½™åŠ›ãŒãªã„ â†’ ã»ã¼æ­¢ã¾ã‚‹ --> -->
    """)
    return


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    <!-- ---
    ### ä½ç›¸ç·š

    (1.)ã‚’

    $$
    \frac{dT}{dt} = f(T)
    $$

    ã¨ã—ã¦ã€
    ä½ç›¸ç·šã§ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹


    * çŠ¶æ…‹ç©ºé–“ï¼š1æ¬¡å…ƒ

    * $T$è»¸ä¸Šã«ã€ã€Œå¢—ãˆã‚‹ã‹ï¼æ¸›ã‚‹ã‹ã€ã‚’ çŸ¢å°ã§è¡¨ã™


    <!-- $y = 0$ ã®ç›´ç·š
    çŠ¶æ…‹ã¯ã€Œç‚¹ã€ã§ã¯ãªã ä½ç½® N
    æ™‚é–“æ–¹å‘ã¯ çŸ¢å°
    ğŸ‘‰ **ã€Œæ™‚é–“ã‚’æ¶ˆã—ã¦ã€æµã‚Œã ã‘ã‚’è¦‹ã‚‹ã€**ã®ãŒä½ç›¸ç·š -->


    * $\dfrac{dT}{dt}$ãŒæ­£ â†’ å³å‘ãçŸ¢å°

    * $\dfrac{dT}{dt}$ãŒè²  â†’ å·¦å‘ãçŸ¢å°

    <!--
    **å¹³è¡¡ç‚¹ï¼ˆå¢—æ¸›ãŒ0ï¼‰**

    $$
    f(N)=0 \Rightarrow
    N=0,\; N=N_\infty
    $$ --> -->
    """)
    return


@app.cell
def _(k_, np, plt):
    def _():
        # T ã®ç¯„å›²
        T_ = np.linspace(-4, 48, 300)

        # å¾®åˆ†æ–¹ç¨‹å¼
        dTdt = -k_ * T_

        plt.figure(figsize=(9, 2))
        plt.axhline(0, color="black", linewidth=1)

        # çŸ¢å°ã®é•·ã•ï¼ˆTã‚¹ã‚±ãƒ¼ãƒ«åŸºæº–ï¼‰
        arrow_len = 1.2

        for T, dT in zip(T_[::20], dTdt[::20]):
            if dT > 0:
                plt.arrow(T, 0, arrow_len, 0,
                          head_width=0.15,
                          head_length=0.4,
                          length_includes_head=True,
                          fc='black', ec='black')
            elif dT < 0:
                plt.arrow(T, 0, -arrow_len, 0,
                          head_width=0.15,
                          head_length=0.4,
                          length_includes_head=True,
                          fc='black', ec='black')

        # å¹³è¡¡ç‚¹
        plt.plot(0, 0, 'o', color='black')
        plt.text(0, 0.18, '0', ha='center')

        # è£…é£¾
        plt.ylim(-1, 1)
        plt.yticks([])
        plt.xlabel('T')
        plt.title(r'Phase line of $\dot T = -kT$')
        plt.tight_layout()
        return plt.show()


    _()
    return


if __name__ == "__main__":
    app.run()
