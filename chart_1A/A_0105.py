import marimo

__generated_with = "0.18.4"
app = marimo.App(width="medium")


@app.cell
def _():
    import marimo as mo
    from fractions import Fraction
    from math import comb
    import random

    return Fraction, comb, mo, random


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    ### **å•é¡Œ105**
    èµ¤ç‰5å€‹ã€é»’ç‰3å€‹ã€ç™½ç‰4å€‹ãŒå…¥ã£ã¦ã„ã‚‹è¢‹ã®ä¸­ã‹ã‚‰ã€ç‰ã‚’1å€‹å–ã‚Šå‡ºã—ã€è‰²ã‚’ç¢ºèªã—ã¦ã‹ã‚‰è¢‹ã®ä¸­ã¸æˆ»ã™ã¨ã„ã†è©¦è¡Œã‚’è€ƒãˆã‚‹ã€‚ã“ã®è©¦è¡Œã‚’3å›è¡Œã£ãŸã¨ãã€2å›ã ã‘åŒã˜è‰²ã¨ãªã‚‹ç¢ºç‡ã‚’æ±‚ã‚ã‚ˆã€‚

    ---

    * èµ¤ç‰ã®å ´åˆ

    $k(k=1, 2, 3)$å›ç›®ã«èµ¤ç‰ãŒå‡ºã‚‹äº‹è±¡ã‚’ã€$A_k$ã§è¡¨ã™ã€‚


    å„è©¦è¡Œã§èµ¤ç‰ãŒå‡ºã‚‹ç¢ºç‡ã¯ç‹¬ç«‹ã§åŒæ§˜ã«ç¢ºã‹ã‚‰ã—ãã€

    $$
    P(A_k) =  \frac{5}{12}
    $$

    $$
    P(\overline{A_k}) =  1-P(A_k) =  \frac{7}{12}
    $$



    * 1å›ç›®ã€2å›ç›®ã«èµ¤ç‰ãŒå‡ºã‚‹ç¢ºç‡(ã€‡ã€‡Ã—)

    $$
    P_{A_1}(A_2) = P(A_2)=  \frac{5}{12}
    $$

    $$
    \begin{aligned}
    P(A_1\cap A_2) &= P(A_1)P_{A_1}(A_2) \\
    &= P(A_1)P(A_2)\\
    &= \frac{5}{12} \cdot\frac{5}{12} = \frac{25}{144}
    \end{aligned}
    $$

    * 2å›ç›®ã€3å›ç›®ã«èµ¤ç‰ãŒå‡ºã‚‹ç¢ºç‡(Ã—ã€‡ã€‡)

    $$
    P_{\overline{A_1}}(A_2) = P(A_2)=  \frac{5}{12}
    $$


    $$
    P_{\overline{A_1}\cap A_2}(A_3) = P(\overline{A_1})P_{\overline{A_1}}(A_2)P(A_3)=  \frac{5}{12}
    $$

    $$
    P(A_1\cap A_2) = P(A_1)P_{A_1}(A_2) = \left(\frac{5}{12}\right)^2 = \frac{25}{144}
    $$



    ï¼(\^o\^)ï¼¼
    """)
    return


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    çµè«–ã‹ã‚‰è¨€ã†ã¨ï¼š

    ğŸ‘‰ **ç™ºæƒ³ã®æ–¹å‘ã¯åˆã£ã¦ã„ã‚‹ãŒã€ãã®ã¾ã¾é€²ã‚€ã¨ã€Œç ´æ»…çš„ã«å¤§å¤‰ã€ã«ãªã‚‹**
    ğŸ‘‰ **ã“ã®å•é¡Œã¯ã€Œè‰²ã‚’ã¾ã¨ã‚ã¦è€ƒãˆã‚‹ã€ã‹ã€Œè£œé›†åˆã€ã§ä¸€æ°—ã«æ•´ç†ã™ã‚‹ã®ãŒæ­£è§£ãƒ«ãƒ¼ãƒˆ**

    ã§ã™ã€‚

    ã¨ã¦ã‚‚è‰¯ã„ã¨ã“ã‚ã¾ã§è€ƒãˆã¦ã„ã¾ã™ã€‚ã ã‹ã‚‰ã“ãã€Œæ•´ç†ã®è»¸ã€ã‚’ä¸€æœ¬å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

    ---

    ## ã¾ãšå•é¡Œã‚’è¨€ã„æ›ãˆã‚‹ï¼ˆè¶…é‡è¦ï¼‰

    > 3å›ã®è©¦è¡Œã®ã†ã¡
    > **ã¡ã‚‡ã†ã©2å›ã ã‘åŒã˜è‰²**
    > ï¼
    > **(åŒã˜è‰²ãŒ2å›) ï¼‹ (æ®‹ã‚Š1å›ã¯åˆ¥ã®è‰²)**

    ã“ã“ã§ã®ãƒã‚¤ãƒ³ãƒˆã¯ï¼š

    * ã€Œèµ¤ãŒ2å›ã€ã§ã‚‚
    * ã€Œé»’ãŒ2å›ã€ã§ã‚‚
    * ã€Œç™½ãŒ2å›ã€ã§ã‚‚ OK

    ã¤ã¾ã‚Š
    ğŸ‘‰ **ã€Œè‰²ã”ã¨ã«å ´åˆåˆ†ã‘ã€ã—ã¦è¶³ã—ç®—ã™ã‚Œã°ã‚ˆã„**

    ---

    ## ã‚ãªãŸã®æ–¹é‡ãŒè¾›ããªã‚‹ç†ç”±

    ã‚ãªãŸã¯ä»Šï¼š

    * èµ¤ãŒå‡ºã‚‹å›ã‚’ $A_1, A_2, A_3$
    * é †ç•ªã”ã¨ã«æ¡ä»¶ä»˜ãç¢ºç‡ã‚’è¿½ã£ã¦ã„ã‚‹

    ã“ã‚Œã¯ç†è«–çš„ã«ã¯æ­£ã—ã„ã§ã™ãŒã€

    * è‰²ãŒ3ç¨®é¡
    * ä¸¦ã³ãŒ $\dbinom{3}{2} = 3$ é€šã‚Š
    * ãã‚Œã‚’è‰²ã”ã¨ã«ã‚„ã‚‹

    â†’ **åœ°ç„** ğŸ˜‡

    é«˜æ ¡ç¢ºç‡ã§ã¯ã€Œç‹¬ç«‹è©¦è¡Œ Ã— çµ„åˆã›ã€ã§æ®´ã‚‹ã®ãŒç‹é“ã§ã™ã€‚

    ---

    ## æ­£ã—ã„æ•´ç†ã®ä»•æ–¹â‘ ï¼ˆè‰²ã”ã¨ã«è€ƒãˆã‚‹ï¼‰

    ### ç¢ºç‡ã®æ•´ç†

    * èµ¤ï¼š$\dfrac{5}{12}$
    * é»’ï¼š$\dfrac{3}{12} = \dfrac{1}{4}$
    * ç™½ï¼š$\dfrac{4}{12} = \dfrac{1}{3}$

    ---

    ### ä¾‹ï¼šèµ¤ãŒã¡ã‚‡ã†ã©2å›å‡ºã‚‹ç¢ºç‡

    * èµ¤ãŒå‡ºã‚‹å›ã®é¸ã³æ–¹ï¼š$\dbinom{3}{2} = 3$
    * ç¢ºç‡ï¼š

    $$
    \binom{3}{2}
    \left(\frac{5}{12}\right)^2
    \left(1-\frac{5}{12}\right)=
    3 \cdot \left(\frac{5}{12}\right)^2 \cdot \frac{7}{12}
    $$

    ---

    ### åŒæ§˜ã«

    * é»’ãŒã¡ã‚‡ã†ã©2å›

    $$
    3 \cdot \left(\frac{3}{12}\right)^2 \cdot \frac{9}{12}
    $$

    * ç™½ãŒã¡ã‚‡ã†ã©2å›

    $$
    3 \cdot \left(\frac{4}{12}\right)^2 \cdot \frac{8}{12}
    $$

    ---

    ### æœ€çµ‚çš„ã«è¶³ã™

    $$
    \boxed{
    3\left[
    \left(\frac{5}{12}\right)^2\frac{7}{12}
    +
    \left(\frac{3}{12}\right)^2\frac{9}{12}
    +
    \left(\frac{4}{12}\right)^2\frac{8}{12}
    \right]
    }
    $$

    ã“ã‚Œã§çµ‚äº†ã§ã™ã€‚

    ---

    ## æ­£ã—ã„æ•´ç†ã®ä»•æ–¹â‘¡ï¼ˆè£œé›†åˆã¨ã„ã†è¦–ç‚¹ï¼‰

    ã€Œã¡ã‚‡ã†ã©2å›åŒã˜è‰²ã€
    ï¼
    **å…¨äº‹è±¡ âˆ’ï¼ˆå…¨éƒ¨åŒã˜è‰²ï¼‰âˆ’ï¼ˆå…¨éƒ¨é•ã†è‰²ï¼‰**

    ã“ã‚Œã‚‚éå¸¸ã«ç¾ã—ã„è§£æ³•ã§ã™ãŒã€

    * ã€Œå…¨éƒ¨é•ã†è‰²ã€ã‚’æ•°ãˆã‚‹ã®ãŒå°‘ã—å·¥å¤«ãŒå¿…è¦

    ãªã®ã§ã€ä»Šã¯â‘ ã®æ–¹ãŒç´ ç›´ã§ã™ã€‚

    ---

    ## ã‚ãªãŸã®æ–¹é‡ã¸ã®è©•ä¾¡ï¼ˆé‡è¦ï¼‰

    âœ” ç‹¬ç«‹æ€§ã®ç†è§£ â†’ **å®Œç’§**

    âœ” æ¡ä»¶ä»˜ãç¢ºç‡ã®ä½¿ã„æ–¹ â†’ **æ­£ã—ã„**

    âŒ å•é¡Œæ§‹é€ ã«å¯¾ã—ã¦ç´°ã‹ã™ãã‚‹åˆ†è§£ â†’ **éåŠ¹ç‡**

    ã“ã‚Œã¯ **æ•°å­¦åŠ›ãŒè¶³ã‚Šãªã„ã®ã§ã¯ãªãã€è¦–ç‚¹ãŒ1æ®µéšãƒŸã‚¯ãƒ­ã™ãã‚‹** ã ã‘ã§ã™ã€‚

    ---

    ## ã²ã¨ã“ã¨ã§ã¾ã¨ã‚

    > ã“ã®å•é¡Œã¯
    >
    > **ã€Œé †ç•ªã€ã‚’è¿½ã†å•é¡Œã§ã¯ãªãã€
    >
    > ã€Œå›æ•°ã€ã‚’æ•°ãˆã‚‹å•é¡Œ**

    ã ã‹ã‚‰ï¼š

    * æ™‚ç³»åˆ—ï¼ˆ(A_1, A_2, A_3)ï¼‰ âŒ
    * å›æ•°ï¼‹çµ„åˆã›ï¼ˆäºŒé …åˆ†å¸ƒçš„ç™ºæƒ³ï¼‰ â­•
    """)
    return


@app.cell
def _(Fraction, comb):
    pR = Fraction(5,12)
    pB = Fraction(3,12)
    pW = Fraction(4,12)

    P = comb(3,2) * (
        pR**2 * (1-pR)
      + pB**2 * (1-pB)
      + pW**2 * (1-pW)
    )

    P

    return


@app.cell
def _(random):
    # ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­æ³•
    colors = ["R"]*5 + ["B"]*3 + ["W"]*4

    def trial():
        draws = [random.choice(colors) for _ in range(3)]
        counts = {c: draws.count(c) for c in set(draws)}
        return 2 in counts.values()

    N = 1_000_000
    cnt = sum(trial() for _ in range(N))

    cnt / N

    return


@app.cell(hide_code=True)
def _(mo):
    mo.md(r"""
    <!-- äº†è§£ã§ã™ã€‚ã§ã¯ **åŒã˜å•é¡Œã‚’ã€Œ3ã¤ã®è¦–ç‚¹ã€ã‹ã‚‰å®Œå…¨ã«æ•´ç†**ã—ã¾ã™ã€‚
    ã“ã®å•é¡Œã€å®Ÿã¯ç¢ºç‡ã®ç†è§£ã‚’ä¸€æ®µå¼•ãä¸Šã’ã‚‹è‰¯å•ã§ã™ã€‚ -->

    ---

    ### å•é¡Œã®å†æ²ï¼ˆæ•´ç†ï¼‰

    è¢‹ï¼š

    * èµ¤ 5ã€é»’ 3ã€ç™½ 4ï¼ˆåˆè¨ˆ 12ï¼‰

    è©¦è¡Œï¼š

    * **æˆ»ã—ã‚ã‚Š**ã§ 3 å›

    æ±‚ã‚ã‚‹ã‚‚ã®ï¼š

    > **3å›ä¸­ã¡ã‚‡ã†ã©2å›ã ã‘åŒã˜è‰²ã«ãªã‚‹ç¢ºç‡**

    ---

    ### â‘  äºŒé …åˆ†å¸ƒã¨ã—ã¦ã©ã†æ›¸ãã‹

    #### ç™ºæƒ³

    ã€Œèµ¤ãŒ2å›å‡ºã‚‹ç¢ºç‡ã€ã€Œé»’ãŒ2å›å‡ºã‚‹ç¢ºç‡ã€ã€Œç™½ãŒ2å›å‡ºã‚‹ç¢ºç‡ã€ã‚’
    **ãã‚Œãã‚ŒäºŒé …åˆ†å¸ƒã§æ›¸ã„ã¦è¶³ã™**ã€‚

    ---

    #### ä¸€èˆ¬å½¢ï¼ˆã“ã“ãŒé‡è¦ï¼‰

    è‰² $C$ ã®å‡ºã‚‹ç¢ºç‡ã‚’ $p_C$ ã¨ã™ã‚‹ã¨ã€

    $$
    P(\text{è‰² }C\text{ ãŒã¡ã‚‡ã†ã©2å›})
    = \binom{3}{2} p_C^2 (1-p_C)
    $$

    ---

    ## å„è‰²ã«å½“ã¦ã¯ã‚ã‚‹

    * èµ¤ï¼š $p_R=\frac{5}{12}$
    * é»’ï¼š $p_B=\frac{3}{12}$
    * ç™½ï¼š $p_W=\frac{4}{12}$

    $$
    \begin{aligned}
    P
    &= \binom{3}{2}
    \Big[
    \left(\frac{5}{12}\right)^2\left(\frac{7}{12}\right)
    +
    \left(\frac{3}{12}\right)^2\left(\frac{9}{12}\right)
    +
    \left(\frac{4}{12}\right)^2\left(\frac{8}{12}\right)
    \Big]
    \end{aligned}
    $$

    ã“ã‚ŒãŒ **äºŒé …åˆ†å¸ƒãƒ«ãƒ¼ãƒˆã®å®Œæˆå½¢**ã€‚

    ğŸ‘‰ ã‚ãªãŸãŒã‚„ã£ã¦ã„ãŸ
    ã€Œé †ç•ªã”ã¨ã« $A_1,A_2,A_3$ ã‚’è¿½ã†æ–¹æ³•ã€ã¯
    **ã“ã®å¼ã‚’åŠ›æŠ€ã§å±•é–‹ã—ã¦ã„ã‚‹ã ã‘**ã§ã—ãŸã€‚

    <!-- ---

    # â‘¡ marimo / Python ã§ç¢ºèªã™ã‚‹

    æ•°å¼ãŒåˆã£ã¦ã„ã‚‹ã‹ã‚’ **è¨ˆç®—ã¨ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸¡æ–¹**ã§ç¢ºèªã—ã¾ã™ã€‚

    ---

    ## â‘¡-1 æ•°å¼è¨ˆç®—ï¼ˆå³å¯†ï¼‰

    ```python
    from fractions import Fraction
    from math import comb

    pR = Fraction(5,12)
    pB = Fraction(3,12)
    pW = Fraction(4,12)

    P = comb(3,2) * (
        pR**2 * (1-pR)
      + pB**2 * (1-pB)
      + pW**2 * (1-pW)
    )

    P
    ```

    ğŸ‘‰ åˆ†æ•°ã®ã¾ã¾æ­£ç¢ºã«è¨ˆç®—ã§ãã¾ã™ã€‚

    ---

    ## â‘¡-2 ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    ã€Œæœ¬å½“ã«ãã†ãªã‚‹ï¼Ÿã€ã‚’æ„Ÿè¦šçš„ã«ç¢ºèªã€‚

    ```python
    import random

    colors = ["R"]*5 + ["B"]*3 + ["W"]*4

    def trial():
        draws = [random.choice(colors) for _ in range(3)]
        counts = {c: draws.count(c) for c in set(draws)}
        return 2 in counts.values()

    N = 1_000_000
    cnt = sum(trial() for _ in range(N))

    cnt / N
    ```

    ğŸ‘‰ æ•°å¼ã®å€¤ã«ã‹ãªã‚Šè¿‘ã¥ãã¯ãšã§ã™ã€‚

    ---

    ## marimo çš„ã¾ã¨ã‚æ–¹ï¼ˆãŠã™ã™ã‚ï¼‰

    * ä¸Šï¼šç†è«–å¼
    * ä¸­ï¼šPythonè¨ˆç®—
    * ä¸‹ï¼šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    ğŸ‘‰ **ã€Œé«˜æ ¡ç¢ºç‡ â†” è¨ˆç®—æ©Ÿã€ãŒä¸€æœ¬ã§ã¤ãªãŒã‚‹**

    ---

    # â‘¢ è£œé›†åˆãƒ«ãƒ¼ãƒˆã‚’ãã‚Œã„ã«æ›¸ã

    ã“ã‚Œã¯ **ä¸€æ®µä¸Šã®è¦‹æ–¹** ã§ã™ã€‚

    --- -->

    ### è£œé›†åˆã®åˆ†è§£

    ã€Œã¡ã‚‡ã†ã©2å›åŒã˜è‰²ã€
    ï¼
    **å…¨ä½“ âˆ’ï¼ˆå…¨éƒ¨åŒã˜è‰²ï¼‰âˆ’ï¼ˆå…¨éƒ¨é•ã†è‰²ï¼‰**

    ---

    #### (1) å…¨éƒ¨åŒã˜è‰²

    * èµ¤3å›ï¼š$(5/12)^3$
    * é»’3å›ï¼š$(3/12)^3$
    * ç™½3å›ï¼š$(4/12)^3$

    $$
    P(\text{å…¨éƒ¨åŒã˜})=
    \left(\frac{5}{12}\right)^3+
    \left(\frac{3}{12}\right)^3+
    \left(\frac{4}{12}\right)^3
    $$

    ---

    ### (2) å…¨éƒ¨é•ã†è‰²

    * è‰²ã®ä¸¦ã³ï¼š$3! = 6$ é€šã‚Š
    * å„ä¸¦ã³ã®ç¢ºç‡ï¼š

    $$
    \frac{5}{12}\cdot\frac{3}{12}\cdot\frac{4}{12}
    $$

    $$
    P(\text{å…¨éƒ¨é•ã†})=
    6 \cdot
    \frac{5\cdot3\cdot4}{12^3}
    $$

    ---

    ## (3) çµè«–

    $$
    \boxed{
    P=
    \left[
    \left(\frac{5}{12}\right)^3+
    \left(\frac{3}{12}\right)^3+
    \left(\frac{4}{12}\right)^3
    \right]=
    6\cdot
    \frac{5\cdot3\cdot4}{12^3}
    }
    $$

    ğŸ‘‰ ã“ã‚Œã‚‚ **åŒã˜ç­”ãˆ**ã«ãªã‚Šã¾ã™ã€‚
    """)
    return


if __name__ == "__main__":
    app.run()
